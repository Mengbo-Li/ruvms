<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>*ruvms*: Get started â€¢ ruvms</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="*ruvms*: Get started">
<meta property="og:description" content="ruvms">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ruvms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ruvms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Mengbo-Li/ruvms/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ruvms_files/header-attrs-2.9/header-attrs.js"></script><script src="ruvms_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="ruvms_files/jquery-3.5.1/jquery.min.js"></script><link href="ruvms_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="ruvms_files/datatables-binding-0.18/datatables.js"></script><link href="ruvms_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="ruvms_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="ruvms_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="ruvms_files/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="ruvms_files/crosstalk-1.1.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>
<em>ruvms</em>: Get started</h1>
                        <h4 class="author">Mengbo Li</h4>
            <address class="author_afil">
      School of Mathematics and Statistics, The University of Sydney, Australia<br><small class="dont-index">Source: <a href="https://github.com/Mengbo-Li/ruvms/blob/master/vignettes/ruvms.Rmd"><code>vignettes/ruvms.Rmd</code></a></small>
      <div class="hidden name"><code>ruvms.Rmd</code></div>

    </address>
</div>

    
    
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p>Here we present an example of the <em>ruvms</em> workflow that includes data normalisation and a simple downstream differential expression analysis using the Sydney Heart Bank (SHB) proteomics data.</p>
</div>
<div id="install-ruvms" class="section level1">
<h1 class="hasAnchor">
<a href="#install-ruvms" class="anchor"></a>Install <code>ruvms</code>
</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages('devtools')</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"Mengbo-Li/ruvms"</span><span class="op">)</span></code></pre></div>
</div>
<div id="load-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#load-packages" class="anchor"></a>Load packages</h1>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/njtierney/naniar">naniar</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Mengbo-Li/ruvms">ruvms</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://bioinf.wehi.edu.au/limma">limma</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT">DT</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://www-personal.umich.edu/~johanngb/ruv/">ruv</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RfastOfficial/Rfast">Rfast</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://Matrix.R-forge.R-project.org/">Matrix</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="load-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load data</h1>
<p>The Sydney Heart Bank (SHB) proteomics data are loaded with corresponding sample information.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"shb_proteomics"</span>, <span class="at">package =</span> <span class="st">"ruvms"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(raw)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]   <span class="dv">70</span> <span class="dv">3263</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>raw[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>   A0A024QZX5<span class="sc">~</span>SERPINB6 A0A024R216<span class="sc">~</span>HDGFRP3 A0A024R442<span class="sc">~</span>DNPEP A0A024R4E5<span class="sc">~</span>HDLBP A0A024R4K9<span class="sc">~</span>TMEM120A</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>               <span class="dv">159132</span>             <span class="dv">107574</span>           <span class="dv">116363</span>               <span class="cn">NA</span>               <span class="dv">91374</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>               <span class="dv">194923</span>              <span class="dv">62334</span>           <span class="dv">100959</span>               <span class="cn">NA</span>                  <span class="cn">NA</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>               <span class="dv">164094</span>              <span class="dv">64548</span>            <span class="dv">79290</span>            <span class="dv">23625</span>               <span class="dv">59086</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>               <span class="dv">241305</span>              <span class="dv">81340</span>           <span class="dv">112981</span>            <span class="dv">26084</span>               <span class="dv">66209</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>              <span class="dv">219515</span>              <span class="dv">61534</span>            <span class="dv">96913</span>            <span class="dv">19160</span>               <span class="dv">63767</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(smpinfo)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">70</span>  <span class="dv">5</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(smpinfo)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  ind  locBank condition location  bank</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">1</span> LV_5<span class="fl">.084</span>     Donor       LV <span class="fl">5.084</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">4</span> LV_6<span class="fl">.024</span>     Donor       LV <span class="fl">6.024</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   <span class="dv">8</span> LV_4<span class="fl">.095</span>     Donor       LV <span class="fl">4.095</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>   <span class="dv">9</span> LV_5<span class="fl">.128</span>     Donor       LV <span class="fl">5.128</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">14</span> LV_7<span class="fl">.028</span>     Donor       LV <span class="fl">7.028</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  <span class="dv">15</span> LV_7<span class="fl">.080</span>     Donor       LV <span class="fl">7.080</span></span></code></pre></div>
</div>
<div id="pre-processing-and-data-normalisation" class="section level1">
<h1 class="hasAnchor">
<a href="#pre-processing-and-data-normalisation" class="anchor"></a>Pre-processing and data normalisation</h1>
<p>Here we demonstrate the workflow using the SHB proteomics data.</p>
<p>(0.1) Log2 transformation</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>raw <span class="ot">&lt;-</span> <span class="fu">log2</span>(raw)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>raw[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>   A0A024QZX5<span class="sc">~</span>SERPINB6 A0A024R216<span class="sc">~</span>HDGFRP3 A0A024R442<span class="sc">~</span>DNPEP A0A024R4E5<span class="sc">~</span>HDLBP A0A024R4K9<span class="sc">~</span>TMEM120A</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>                 <span class="fl">17.3</span>               <span class="fl">16.7</span>             <span class="fl">16.8</span>               <span class="cn">NA</span>                <span class="fl">16.5</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>                 <span class="fl">17.6</span>               <span class="fl">15.9</span>             <span class="fl">16.6</span>               <span class="cn">NA</span>                  <span class="cn">NA</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>                 <span class="fl">17.3</span>               <span class="fl">16.0</span>             <span class="fl">16.3</span>             <span class="fl">14.5</span>                <span class="fl">15.9</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>                 <span class="fl">17.9</span>               <span class="fl">16.3</span>             <span class="fl">16.8</span>             <span class="fl">14.7</span>                <span class="fl">16.0</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>                <span class="fl">17.7</span>               <span class="fl">15.9</span>             <span class="fl">16.6</span>             <span class="fl">14.2</span>                <span class="fl">16.0</span></span></code></pre></div>
<p>(0.2) Missing data patterns</p>
<ul>
<li>Total proportion of missingness:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(raw))<span class="sc">/</span><span class="fu">length</span>(raw)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.121</span></span></code></pre></div>
<ul>
<li>Missingness in samples:</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">raw</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Number of NA observations"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Number of NAs in each protein (n = 73)"</span><span class="op">)</span></code></pre></div>
<p><img src="ruvms_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<ul>
<li>Missingness by proteins:</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">raw</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">raw</span><span class="op">)</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Proportion of NA proteins"</span>,
    y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Proportion of NA proteins in each sample (p = 3,263)"</span><span class="op">)</span></code></pre></div>
<p><img src="ruvms_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<ol style="list-style-type: decimal">
<li>Choosing negative control measurements.</li>
</ol>
<p>Here, we use the low sample variance proteins as the negative controls:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ctl <span class="ot">&lt;-</span> <span class="fu">colVars</span>(raw) <span class="sc">&lt;=</span> <span class="fu">quantile</span>(<span class="fu">colVars</span>(raw, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">probs =</span> <span class="fl">0.25</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ctl)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>ctl</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="cn">FALSE</span>  <span class="cn">TRUE</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">1050</span>   <span class="dv">624</span> </span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Identify the replication structure</li>
</ol>
<p>The SHB data set contains 70 samples, where 7 of them have one replicate.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">duplicated</span>(smpinfo<span class="sc">$</span>locBank))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">7</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">replicate.matrix</span>(smpinfo<span class="sc">$</span>locBank)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(M) <span class="ot">&lt;-</span> smpinfo<span class="sc">$</span>locBank</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(M)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">70</span> <span class="dv">63</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Perform <code>ruvms</code> normalisation</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>normed <span class="ot">&lt;-</span> <span class="fu">ruvms</span>(raw, M, ctl)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>normed[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>   A0A024QZX5<span class="sc">~</span>SERPINB6 A0A024R216<span class="sc">~</span>HDGFRP3 A0A024R442<span class="sc">~</span>DNPEP A0A024R4E5<span class="sc">~</span>HDLBP A0A024R4K9<span class="sc">~</span>TMEM120A</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>                 <span class="fl">17.4</span>               <span class="fl">16.8</span>             <span class="fl">16.8</span>               <span class="cn">NA</span>                <span class="fl">16.5</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>                 <span class="fl">17.6</span>               <span class="fl">16.0</span>             <span class="fl">16.6</span>               <span class="cn">NA</span>                  <span class="cn">NA</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>                 <span class="fl">17.4</span>               <span class="fl">16.1</span>             <span class="fl">16.3</span>             <span class="fl">14.6</span>                <span class="fl">15.8</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>                 <span class="fl">17.9</span>               <span class="fl">16.4</span>             <span class="fl">16.8</span>             <span class="fl">14.7</span>                <span class="fl">16.0</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>                <span class="fl">17.6</span>               <span class="fl">16.0</span>             <span class="fl">16.6</span>             <span class="fl">14.4</span>                <span class="fl">15.8</span></span></code></pre></div>
<div id="diagnostics" class="section level2">
<h2 class="hasAnchor">
<a href="#diagnostics" class="anchor"></a>Diagnostics</h2>
<ol style="list-style-type: lower-roman">
<li>PCA</li>
</ol>
<p>Normalisation is performed on the data set with missingness, but PCA is produced by subsetting the raw and normalised data to complete subsets.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gg_additions_heart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">smpinfo</span><span class="op">$</span><span class="va">condition</span>, shape <span class="op">=</span> <span class="va">smpinfo</span><span class="op">$</span><span class="va">location</span>,
    size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, <span class="fu">labs</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Condition"</span>, shape <span class="op">=</span> <span class="st">"Location"</span><span class="op">)</span>,
    <span class="fu">scale_size_identity</span><span class="op">(</span>guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>, <span class="fu">guides</span><span class="op">(</span>color <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,
        shape <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
    <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">ggPCA</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">pcs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="va">pcs</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">PC1</span>, y <span class="op">=</span> <span class="va">PC2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="va">gg_additions_heart</span> <span class="op">+</span>
        <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">pca_raw</span> <span class="op">&lt;-</span> <span class="fu">ggPCA</span><span class="op">(</span><span class="va">raw</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">raw</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Raw data"</span><span class="op">)</span>
<span class="va">pca_norm</span> <span class="op">&lt;-</span> <span class="fu">ggPCA</span><span class="op">(</span><span class="va">normed</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">normed</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Normalised data"</span><span class="op">)</span>
<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">pca_raw</span>, <span class="va">pca_norm</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="ruvms_files/figure-html/unnamed-chunk-11-1.png" width="1152"></p>
<p>It is shown that conditions in <code>ruvms</code> normalised data are better separated.</p>
<ol start="2" style="list-style-type: lower-roman">
<li>RLA</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/RLA.html">RLA</a></span><span class="op">(</span><span class="va">raw</span>, repCol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">[</span><span class="va">smpinfo</span><span class="op">$</span><span class="va">condition</span><span class="op">]</span>,
    repLabel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">smpinfo</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span>, title <span class="op">=</span> <span class="st">"Raw data"</span>,
    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, guides <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/RLA.html">RLA</a></span><span class="op">(</span><span class="va">normed</span>, repCol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">[</span><span class="va">smpinfo</span><span class="op">$</span><span class="va">condition</span><span class="op">]</span>,
    repLabel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">smpinfo</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span>, title <span class="op">=</span> <span class="st">"Normalised data"</span>,
    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, guides <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ruvms_files/figure-html/unnamed-chunk-12-1.png" width="1248"></p>
<p>Ideally, given a properly normalised data matrix, RLA boxplots are expected to be aligned around zero, and the widths of the boxplots should be relatively narrow and concordant with each other. We can see in our example, not only are the RLA boxplots better aligned at zero, but the widths of the of the boxplots are shrinked and more concordant post normalisation.</p>
<ol start="3" style="list-style-type: lower-roman">
<li>TRA</li>
</ol>
<p>TRA boxplots measure the similarity among replications of the same effective sample. The widths of TRA boxplots are proportional to variations among technical replicates. Provided effective removal of unwanted variations from data, technical replicates are expected to be identical after normalisation.</p>
<p>The <code>ruvms</code> normalisation makes technical replications the same, thereby the widths of the TRA boxplots are zero after normalisation.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>smp_w_rep <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rowSums</span>(M[, <span class="fu">colSums</span>(M) <span class="sc">==</span> <span class="dv">2</span>]) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>smp_w_rep <span class="ot">&lt;-</span> <span class="fu">filter</span>(smpinfo, locBank <span class="sc">%in%</span> <span class="fu">names</span>(smp_w_rep)) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(locBank)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>smp_w_rep</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>   ind  locBank condition location  bank</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">11</span> LV_4<span class="fl">.001</span>       ICM       LV <span class="fl">4.001</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">62</span> LV_4<span class="fl">.001</span>       ICM       LV <span class="fl">4.001</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>    <span class="dv">3</span> LV_4<span class="fl">.039</span>       ICM       LV <span class="fl">4.039</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>    <span class="dv">6</span> LV_4<span class="fl">.039</span>       ICM       LV <span class="fl">4.039</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>    <span class="dv">7</span> LV_4<span class="fl">.070</span>       ICM       LV <span class="fl">4.070</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>   <span class="dv">71</span> LV_4<span class="fl">.070</span>       ICM       LV <span class="fl">4.070</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>    <span class="dv">8</span> LV_4<span class="fl">.095</span>     Donor       LV <span class="fl">4.095</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>   <span class="dv">50</span> LV_4<span class="fl">.095</span>     Donor       LV <span class="fl">4.095</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>   <span class="dv">34</span> LV_5<span class="fl">.045</span>       DCM       LV <span class="fl">5.045</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="dv">65</span> LV_5<span class="fl">.045</span>       DCM       LV <span class="fl">5.045</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>   <span class="dv">4</span> LV_6<span class="fl">.024</span>     Donor       LV <span class="fl">6.024</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>  <span class="dv">53</span> LV_6<span class="fl">.024</span>     Donor       LV <span class="fl">6.024</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>  <span class="dv">14</span> LV_7<span class="fl">.028</span>     Donor       LV <span class="fl">7.028</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>  <span class="dv">63</span> LV_7<span class="fl">.028</span>     Donor       LV <span class="fl">7.028</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="fu">TRA</span>(raw[smp_w_rep<span class="sc">$</span>ind, ], <span class="at">replicates =</span> smp_w_rep<span class="sc">$</span>locBank, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="fl">2.2</span>), <span class="at">title =</span> <span class="st">"Raw data"</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="fu">TRA</span>(normed[smp_w_rep<span class="sc">$</span>ind, ], <span class="at">replicates =</span> smp_w_rep<span class="sc">$</span>locBank,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.2</span>), <span class="at">title =</span> <span class="st">"Normalised data"</span>)</span></code></pre></div>
<p><img src="ruvms_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
<p>To further demonstrate the use of TRA plots, we also visualise the variations among the same condition, that is, Donors, DCMs and ICMs.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/TRA.html">TRA</a></span><span class="op">(</span><span class="va">raw</span>, replicates <span class="op">=</span> <span class="va">smpinfo</span><span class="op">$</span><span class="va">condition</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">3</span>,
    <span class="st">"Dark2"</span><span class="op">)</span>, title <span class="op">=</span> <span class="st">"Raw data"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/TRA.html">TRA</a></span><span class="op">(</span><span class="va">normed</span>, replicates <span class="op">=</span> <span class="va">smpinfo</span><span class="op">$</span><span class="va">condition</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">3</span>,
    <span class="st">"Dark2"</span><span class="op">)</span>, title <span class="op">=</span> <span class="st">"Normalised data"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ruvms_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<p>We can see that the variations within the same condition are reduced after normalisation.</p>
<p>Something extra: In <code><a href="https://rdrr.io/pkg/ruv/man/RUVIII.html">ruv::RUVIII</a></code>, the <code>k</code> parameter determines the amount of adjustment performed on the raw data set. The TRA plots are also useful to show that the larger <code>k</code> is, the more similar technical replications are after normalisation. That is, the heights of the TRA boxplots become smaller as <code>k</code> increases to its maximum.</p>
<ol start="4" style="list-style-type: lower-roman">
<li>MDA plots</li>
</ol>
<p>The MDA plots shows how the median of each measurement shifts before and after normalisation. MDA plots are useful for the selection of the <code>lambda</code> parameter when <code>standardise</code> is disabled:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">ruvms_lambda0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ruvms.html">ruvms</a></span><span class="op">(</span><span class="va">raw</span>, <span class="va">M</span>, <span class="va">ctl</span>, standardise <span class="op">=</span> <span class="cn">FALSE</span>, lambda <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="../reference/MDA.html">MDA</a></span><span class="op">(</span><span class="va">raw</span>, <span class="va">ruvms_lambda0</span>, outline <span class="op">=</span> <span class="cn">TRUE</span>, guides <span class="op">=</span> <span class="fl">0</span>, title <span class="op">=</span> <span class="st">"lambda = 0"</span><span class="op">)</span>
<span class="va">ruvms_w_lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ruvms.html">ruvms</a></span><span class="op">(</span><span class="va">raw</span>, <span class="va">M</span>, <span class="va">ctl</span>, standardise <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/MDA.html">MDA</a></span><span class="op">(</span><span class="va">raw</span>, <span class="va">ruvms_w_lambda</span>, outline <span class="op">=</span> <span class="cn">TRUE</span>, guides <span class="op">=</span> <span class="fl">0</span>, title <span class="op">=</span> <span class="st">"lambda = 1e-5"</span><span class="op">)</span></code></pre></div>
<p><img src="ruvms_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<p>We can see that there are huge shifts in the range of each protein after normalisation when there is no <span class="math inline">\(lambda\)</span>-regularisation. A very small <span class="math inline">\(lambda\)</span>-regularisation helps.</p>
</div>
</div>
<div id="differential-expression-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#differential-expression-analysis" class="anchor"></a>Differential expression analysis</h1>
<p>With normalised data, we then perform a simple differential expression analysis on the disease conditions. The factor of interest is the disease conditions, including the healthy donors (Donor), DCM hearts and ICM hearts. We are interested in the differentially abundant proteins in DCM and ICM versus Donor hearts respectively.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">normed_avg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ruvms.html">ruvms</a></span><span class="op">(</span><span class="va">raw</span>, <span class="va">M</span>, <span class="va">ctl</span>, average <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">effective_smp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">smpinfo</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">locBank</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">arrange</span><span class="op">(</span><span class="va">locBank</span><span class="op">)</span>

<span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="fl">0</span> <span class="op">+</span> <span class="va">condition</span> <span class="op">+</span> <span class="va">location</span>, data <span class="op">=</span> <span class="va">effective_smp</span><span class="op">)</span>
<span class="va">contrasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/makeContrasts.html">makeContrasts</a></span><span class="op">(</span>DCM <span class="op">=</span> <span class="va">conditionDCM</span> <span class="op">-</span> <span class="va">conditionDonor</span>,
    ICM <span class="op">=</span> <span class="va">conditionICM</span> <span class="op">-</span> <span class="va">conditionDonor</span>, levels <span class="op">=</span> <span class="va">design</span><span class="op">)</span>

<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/lmFit.html">lmFit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">normed_avg</span><span class="op">)</span>, <span class="va">design</span><span class="op">)</span>
<span class="va">cfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/contrasts.fit.html">contrasts.fit</a></span><span class="op">(</span><span class="va">fit</span>, contrasts <span class="op">=</span> <span class="va">contrasts</span><span class="op">)</span>
<span class="va">efit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/ebayes.html">eBayes</a></span><span class="op">(</span><span class="va">cfit</span><span class="op">)</span>

<span class="va">dcm_top</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/limma/man/toptable.html">topTable</a></span><span class="op">(</span><span class="va">efit</span>, coef <span class="op">=</span> <span class="st">"DCM"</span>, number <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,
    <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">dcm_top</span>, caption <span class="op">=</span> <span class="st">"Top 20 differentially abundant proteins in DCM hearts versus healthy donors"</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-a2a1f5468466a2e83ba4" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a2a1f5468466a2e83ba4">{"x":{"filter":"none","caption":"<caption>Top 20 differentially abundant proteins in DCM hearts versus healthy donors<\/caption>","data":[["Q12805~EFEMP1","P04275~VWF","P02787~TF","G3V4U0~FBLN5","P39060~COL18A1","P12110~COL6A2","Q15063~POSTN","P02768~ALB","P35663~CYLC1","P01008~SERPINC1","P13611~VCAN","A0A087X0S5~COL6A1","P04196~HRG","Q16610~ECM1","P12111~COL6A3","O75380~NDUFS6","Q9HCH3~CPNE5","Q02750~MAP2K1","P04217~A1BG","K7ES70~MFAP4"],[1.9,1.4,1.1,1.3,1.1,1.1,2.4,0.89,1,0.77,1.6,1,1.1,1,0.99,-0.31,1.9,-0.39,1.1,1.6],[17,16,21,18,18,22,18,27,18,18,17,21,18,14,21,20,14,17,18,20],[10,8.4,8.4,8.2,8,7.9,7.5,7.4,7.4,7.2,7.2,7.2,7.2,7.4,7.1,-7.1,9.8,-7,7,7],[1.7e-14,7.5e-12,9.3e-12,1.6e-11,4.5e-11,7.2e-11,3.1e-10,4.3e-10,5.5e-10,1.1e-09,1.1e-09,1.1e-09,1.2e-09,1.4e-09,1.4e-09,1.8e-09,9.6e-10,2e-09,2.2e-09,2.6e-09],[5.5e-11,1e-08,1e-08,1.3e-08,2.9e-08,3.9e-08,1.4e-07,1.8e-07,2e-07,2.8e-07,2.8e-07,2.8e-07,2.8e-07,2.9e-07,2.9e-07,3.4e-07,2.8e-07,3.5e-07,3.8e-07,4.3e-07],[23,17,17,16,15,15,13,13,13,12,12,12,12,12,12,11,11,11,11,11]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>logFC<\/th>\n      <th>AveExpr<\/th>\n      <th>t<\/th>\n      <th>P.Value<\/th>\n      <th>adj.P.Val<\/th>\n      <th>B<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>

icm_top </div>
<script type="application/json" data-for="htmlwidget-4f9de3942dbfa8de1450">{"x":{"filter":"none","caption":"<caption>Top 20 differentially abundant proteins in ICM hearts versus healthy donors<\/caption>","data":[["P0DJI8~SAA1","Q12805~EFEMP1","P04275~VWF","P02787~TF","P12110~COL6A2","P04196~HRG","A0A0B4J2C3~TPT1","P35663~CYLC1","Q96DZ1~ERLEC1","A0A087X0S5~COL6A1","P39060~COL18A1","A0A140TA41~TNXB","P12111~COL6A3","P08237~PFKM","G3V4U0~FBLN5","P29622~SERPINA4","P01008~SERPINC1","P19367~HK1","P06727~APOA4","P02768~ALB"],[-3.5,1.5,1.3,1,0.94,1,-0.31,0.93,0.33,0.91,0.85,0.95,0.84,-0.38,0.94,1.1,0.63,0.34,1.4,0.69],[17,17,16,21,22,18,18,18,14,21,18,18,21,21,18,16,18,21,17,27],[-10,8.5,8.2,8.1,7,6.8,-6.8,6.6,6.4,6.3,6.2,6.1,6.1,-6,6,6.1,5.9,5.9,5.8,5.8],[1.5e-14,1.3e-11,2.1e-11,2.4e-11,2.1e-09,5e-09,6.4e-09,1.2e-08,2.5e-08,4e-08,5.9e-08,8.5e-08,9.1e-08,1e-07,1.2e-07,1.2e-07,1.6e-07,1.8e-07,2.8e-07,3e-07],[4.9e-11,2e-08,2e-08,2e-08,1.3e-06,2.7e-06,3e-06,4.7e-06,8.9e-06,1.3e-05,1.7e-05,2.3e-05,2.3e-05,2.4e-05,2.5e-05,2.5e-05,3e-05,3.2e-05,4.6e-05,4.6e-05],[22,16,16,16,11,10,10,9.7,9,8.5,8.1,7.8,7.7,7.6,7.5,7.5,7.2,7.1,6.7,6.6]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>logFC<\/th>\n      <th>AveExpr<\/th>\n      <th>t<\/th>\n      <th>P.Value<\/th>\n      <th>adj.P.Val<\/th>\n      <th>B<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Li, M., Parker, B. L., Pearson, E., Hunter, B., Cao, J., Koay, Y. C., â€¦ &amp; Oâ€™Sullivan, J. F. (2020). Core functional nodes and sex-specific pathways in human ischaemic and dilated cardiomyopathy. <em>Nature communications</em>, 11(1), 1-12.</p>
<p>Ritchie, M. E., Phipson, B., Wu, D. I., Hu, Y., Law, C. W., Shi, W., &amp; Smyth, G. K. (2015). limma powers differential expression analyses for RNA-sequencing and microarray studies. <em>Nucleic acids research</em>, 43(7), e47-e47.</p>
</div>
<div id="session-information" class="section level1">
<h1 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session information</h1>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>R version <span class="dv">4</span>.<span class="fl">0.5</span> (<span class="dv">2021-03-31</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>Platform<span class="sc">:</span> x86_64<span class="sc">-</span>apple<span class="sc">-</span><span class="fu">darwin17.0</span> (<span class="dv">64</span><span class="sc">-</span>bit)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>Running under<span class="sc">:</span> macOS Catalina <span class="dv">10</span>.<span class="fl">15.7</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>Matrix products<span class="sc">:</span> default</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>BLAS<span class="sc">:</span>   <span class="er">/</span>System<span class="sc">/</span>Library<span class="sc">/</span>Frameworks<span class="sc">/</span>Accelerate.framework<span class="sc">/</span>Versions<span class="sc">/</span>A<span class="sc">/</span>Frameworks<span class="sc">/</span>vecLib.framework<span class="sc">/</span>Versions<span class="sc">/</span>A<span class="sc">/</span>libBLAS.dylib</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>LAPACK<span class="sc">:</span> <span class="er">/</span>Library<span class="sc">/</span>Frameworks<span class="sc">/</span>R.framework<span class="sc">/</span>Versions<span class="sc">/</span><span class="fl">4.0</span><span class="sc">/</span>Resources<span class="sc">/</span>lib<span class="sc">/</span>libRlapack.dylib</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>locale<span class="sc">:</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] en_AU.UTF<span class="dv">-8</span><span class="sc">/</span>en_AU.UTF<span class="dv">-8</span><span class="sc">/</span>en_AU.UTF<span class="dv">-8</span><span class="sc">/</span>C<span class="sc">/</span>en_AU.UTF<span class="dv">-8</span><span class="sc">/</span>en_AU.UTF<span class="dv">-8</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>attached base packages<span class="sc">:</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>other attached packages<span class="sc">:</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] Matrix_1<span class="fl">.3</span><span class="dv">-4</span>       Rfast_2.<span class="fl">0.3</span>        RcppZiggurat_0.<span class="fl">1.6</span> Rcpp_1.<span class="fl">0.6</span>         ruv_0.<span class="dv">9</span>.<span class="fl">7.1</span>       </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a> [<span class="dv">6</span>] DT_0<span class="fl">.18</span>            limma_3.<span class="fl">46.0</span>       ruvms_0.<span class="fl">1.0</span>        ggpubr_0.<span class="fl">4.0</span>       naniar_0.<span class="fl">6.1</span>      </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">11</span>] RColorBrewer_1<span class="fl">.1</span><span class="dv">-2</span> forcats_0.<span class="fl">5.1</span>      stringr_1.<span class="fl">4.0</span>      dplyr_1.<span class="fl">0.7</span>        purrr_0.<span class="fl">3.4</span>       </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>[<span class="dv">16</span>] readr_1.<span class="fl">4.0</span>        tidyr_1.<span class="fl">1.3</span>        tibble_3.<span class="fl">1.2</span>       ggplot2_3.<span class="fl">3.5</span>      tidyverse_1.<span class="fl">3.1</span>   </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>[<span class="dv">21</span>] BiocStyle_2.<span class="fl">18.1</span>  </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>loaded via a <span class="fu">namespace</span> (and not attached)<span class="sc">:</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] fs_1.<span class="fl">5.0</span>            lubridate_1.<span class="fl">7.10</span>    httr_1.<span class="fl">4.2</span>          rprojroot_2.<span class="fl">0.2</span>    </span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a> [<span class="dv">5</span>] tools_4.<span class="fl">0.5</span>         backports_1.<span class="fl">2.1</span>     bslib_0.<span class="dv">2</span>.<span class="fl">5.1</span>       utf8_1.<span class="fl">2.1</span>         </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a> [<span class="dv">9</span>] R6_2.<span class="fl">5.0</span>            DBI_1.<span class="fl">1.1</span>           colorspace_2<span class="fl">.0</span><span class="dv">-2</span>    withr_2.<span class="fl">4.2</span>        </span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>[<span class="dv">13</span>] gridExtra_2<span class="fl">.3</span>       tidyselect_1.<span class="fl">1.1</span>    curl_4.<span class="fl">3.2</span>          compiler_4.<span class="fl">0.5</span>     </span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>[<span class="dv">17</span>] textshaping_0.<span class="fl">3.5</span>   cli_3.<span class="fl">0.0</span>           rvest_1.<span class="fl">0.0</span>         formatR_1<span class="fl">.11</span>       </span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>[<span class="dv">21</span>] xml2_1.<span class="fl">3.2</span>          desc_1.<span class="fl">3.0</span>          labeling_0.<span class="fl">4.2</span>      bookdown_0<span class="fl">.22</span>      </span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>[<span class="dv">25</span>] sass_0.<span class="fl">4.0</span>          scales_1.<span class="fl">1.1</span>        pkgdown_1.<span class="fl">6.1</span>       systemfonts_1.<span class="fl">0.2</span>  </span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>[<span class="dv">29</span>] digest_0.<span class="fl">6.27</span>       foreign_0<span class="fl">.8</span><span class="dv">-81</span>      rmarkdown_2<span class="fl">.9</span>       rio_0.<span class="fl">5.27</span>         </span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>[<span class="dv">33</span>] pkgconfig_2.<span class="fl">0.3</span>     htmltools_0.<span class="dv">5</span>.<span class="fl">1.1</span>   highr_0<span class="fl">.9</span>           dbplyr_2.<span class="fl">1.1</span>       </span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>[<span class="dv">37</span>] fastmap_1.<span class="fl">1.0</span>       htmlwidgets_1.<span class="fl">5.3</span>   rlang_0.<span class="fl">4.11</span>        readxl_1.<span class="fl">3.1</span>       </span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>[<span class="dv">41</span>] rstudioapi_0<span class="fl">.13</span>     farver_2.<span class="fl">1.0</span>        jquerylib_0.<span class="fl">1.4</span>     generics_0.<span class="fl">1.0</span>     </span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>[<span class="dv">45</span>] jsonlite_1.<span class="fl">7.2</span>      crosstalk_1.<span class="fl">1.1</span>     zip_2.<span class="fl">2.0</span>           car_3<span class="fl">.0</span><span class="dv">-11</span>         </span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>[<span class="dv">49</span>] magrittr_2.<span class="fl">0.1</span>      munsell_0.<span class="fl">5.0</span>       fansi_0.<span class="fl">5.0</span>         abind_1<span class="fl">.4</span><span class="dv">-5</span>        </span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>[<span class="dv">53</span>] lifecycle_1.<span class="fl">0.0</span>     visdat_0.<span class="fl">5.3</span>        stringi_1.<span class="fl">6.2</span>       yaml_2.<span class="fl">2.1</span>         </span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>[<span class="dv">57</span>] carData_3<span class="fl">.0</span><span class="dv">-4</span>       grid_4.<span class="fl">0.5</span>          parallel_4.<span class="fl">0.5</span>      crayon_1.<span class="fl">4.1</span>       </span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>[<span class="dv">61</span>] lattice_0<span class="fl">.20</span><span class="dv">-44</span>     cowplot_1.<span class="fl">1.1</span>       haven_2.<span class="fl">4.1</span>         hms_1.<span class="fl">1.0</span>          </span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>[<span class="dv">65</span>] knitr_1<span class="fl">.33</span>          pillar_1.<span class="fl">6.1</span>        ggsignif_0.<span class="fl">6.2</span>      reprex_2.<span class="fl">0.0</span>       </span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>[<span class="dv">69</span>] glue_1.<span class="fl">4.2</span>          evaluate_0<span class="fl">.14</span>       data.table_1.<span class="fl">14.0</span>   BiocManager_1.<span class="fl">30.16</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>[<span class="dv">73</span>] modelr_0.<span class="fl">1.8</span>        vctrs_0.<span class="fl">3.8</span>         cellranger_1.<span class="fl">1.0</span>    gtable_0.<span class="fl">3.0</span>       </span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>[<span class="dv">77</span>] assertthat_0.<span class="fl">2.1</span>    cachem_1.<span class="fl">0.5</span>        xfun_0<span class="fl">.24</span>           openxlsx_4.<span class="fl">2.4</span>     </span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>[<span class="dv">81</span>] broom_0.<span class="fl">7.8</span>         rstatix_0.<span class="fl">7.0</span>       ragg_1.<span class="fl">1.3</span>          memoise_2.<span class="fl">0.0</span>      </span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>[<span class="dv">85</span>] ellipsis_0.<span class="fl">3.2</span>     </span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Mengbo Li.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</body>
</html>
